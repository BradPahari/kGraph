<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <title>CSV to Knowledge Graph</title>

    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="{{ url_for('static', filename='images/logo.svg') }}">

    <!-- External styles -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@uswds/uswds@latest/dist/css/uswds.min.css">
    <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-icons/1.5.0/font/bootstrap-icons.min.css" />

    <!-- âœ… Your custom CSS -->
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">

    <!-- Graph library -->
    <script src="https://unpkg.com/vis-network@9.1.2/standalone/umd/vis-network.min.js"></script>
</head>


<body>
    <section class="usa-banner" aria-label="Official website of the Unitezd States government">
        <div class="usa-accordion">
            <header class="usa-banner__header">
                <div class="usa-banner__inner">
                    <div class="grid-col-auto">
                        <img class="usa-banner__header-flag"
                            src="https://designsystem.digital.gov/assets/img/us_flag_small.png" alt="U.S. flag" />
                    </div>
                    <div class="grid-col-fill tablet:grid-col-auto">
                        <p class="usa-banner__header-text">An official website of the United States government</p>
                        <p class="usa-banner__header-action">Here's how you know</p>
                    </div>
                    <button type="button" class="usa-accordion__button usa-banner__button" aria-expanded="false"
                        aria-controls="gov-banner">
                        <span class="usa-banner__button-text">Here's how you know</span>
                    </button>
                </div>
            </header>
            <div class="usa-banner__content usa-accordion__content" id="gov-banner">
                <div class="grid-row grid-gap-lg">
                    <div class="usa-banner__guidance tablet:grid-col-6">
                        <img class="usa-banner__icon usa-media-block__img"
                            src="https://designsystem.digital.gov/assets/img/icon-dot-gov.svg" alt=""
                            aria-hidden="true" />
                        <div class="usa-media-block__body">
                            <p>
                                <strong>Official websites use .gov</strong><br /> A <strong>.gov</strong> website
                                belongs to an official government organization in the United States.
                            </p>
                        </div>
                    </div>
                    <div class="usa-banner__guidance tablet:grid-col-6">
                        <img class="usa-banner__icon usa-media-block__img"
                            src="https://designsystem.digital.gov/assets/img/icon-https.svg" alt=""
                            aria-hidden="true" />
                        <div class="usa-media-block__body">
                            <p>
                                <strong>Secure .gov websites use HTTPS</strong><br /> A <strong>lock</strong> ( <svg
                                    xmlns="http://www.w3.org/2000/svg" width="52" height="64" viewBox="0 0 52 64"
                                    class="usa-banner__lock-image" aria-hidden="true" focusable="false">
                                    <path fill="#000" fill-rule="evenodd"
                                        d="M26 0c10.493 0 19 8.507 19 19v9h3a4 4 0 0 1 4 4v28a4 4 0 0 1-4 4H4a4 4 0 0 1-4-4V32a4 4 0 0 1 4-4h3v-9C7 8.507 15.507 0 26 0zm0 8c-5.979 0-10.843 4.77-10.996 10.712L15 19v9h22v-9c0-6.075-4.925-11-11-11z" />
                                </svg> ) or <strong>https://</strong> means you've safely connected to the .gov website.
                                Share sensitive information only on official, secure websites.
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
    <div id="loginScreen">
        <div class="container flex flex-column flex-align-center">
            <div class="login-box">
                <div class="logo">
                    <img src="static/images/logo.svg" alt="logo" style="width: 100%; height: 100%;">
                </div>
                <h2>Enter your username to continue</h2>
                <input type="text" id="usernameInput" placeholder="Username" />
                <button class="btn" style="width: 100%;" onclick="handleLogin()">Enter</button>
            </div>
        </div>
    </div>
    <div id="mainApp" style="display: none;">
        <header class="header-main">
            <div class="container">
                <div class="logo">
                    <img src="static/images/logo.svg" alt="logo" style="width: 100%; height: 100%;">
                </div>
                <div>
                    <span id="currentUserLabel" style="margin-right: 12px; font-weight: bold;"></span>
                    <button onclick="logoutUser()"
                        style="padding: 8px 12px; font-size: 14px; background-color: #dc2626; color: #fff;"
                        class="btn danger">Log out</button>
                </div>
            </div>
        </header>
        <div class="container">
            <aside id="historySidebar">
                <div class="history-header">
                    <h3>Graph History</h3>
                </div>
                <div id="historyList">
                    <div class="history-bar">
                        <div class="history-list-container">
                            <strong>Load from History:</strong>
                            <div id="historyList" class="history-scroll-list"></div>
                        </div>
                    </div>
                </div>
            </aside>
            <div class="main-content">
                <h2>Upload CSV to Create a Knowledge Graph</h2>
                <div class="upload-section">
                    <div class="icon-img">
                        <svg width="50" height="50" viewBox="0 0 71 53" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <!-- SVG content omitted for brevity -->
                        </svg>
                    </div>
                    <input type="file" id="csvFile" accept=".csv" multiple onchange="handleFileSelect()" />
                    <p style="margin: 0"> Browse for your CSV files <a class="custom-upload-button"
                            onclick="document.getElementById('csvFile').click()"> Select Files </a>
                    </p>
                    <p id="formatMessage" style="margin: 5px 0 0px; font-size: 12px; color: #666"> You can add up to 5
                        files max (Supported format: .csv files only) </p>
                    <div id="selectedFilesList"></div>
                    <button id="uploadAllBtn" onclick="uploadCSV(selectedFiles)" disabled> Upload Selected Files
                    </button>
                </div>
                <div class="dropdowns">
                    <div class="form-group file-group">
                        <label>Subject File:</label>
                        <select id="subjectFileSelect" onchange="updateHeaderDropdowns()" disabled></select>
                    </div>
                    <div class="form-group file-group">
                        <label>Object File:</label>
                        <select id="objectFileSelect" onchange="updateHeaderDropdowns()" disabled></select>
                    </div>
                    <div class="form-group column-group subject-column">
                        <label>Subject Column:</label>
                        <select id="subjectSelect" disabled></select>
                    </div>
                    <div class="form-group column-group object-column">
                        <label>Object Column:</label>
                        <select id="objectSelect" disabled></select>
                    </div>
                    <div class="form-group full-width">
                        <button id="generateBtn" onclick="generateTriples()" disabled>Generate Triple Table</button>
                    </div>

                </div>
                <div id="messageBox"></div>
                <div id="errorBox"></div>
                <div id="tripleTable" class="mb"></div>
                <button id="doneBtn" onclick="submitTriples()" disabled>Done (Build Graph)</button>
                <button id="saveAsBtn" onclick="promptSaveAs()" disabled style="margin-left: 10px;">Save As</button>
                <div class="graph-wrapper">
                    <button id="downloadButton" onclick="downloadGraphImage()"></button>
                    <div id="graph"></div>
                    <div id="infoBox">Click a node or edge to see more details.</div>
                </div>
            </div>
        </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/@uswds/uswds@latest/dist/js/uswds.min.js"></script>
    <script src="{{ url_for('static', filename='script.js') }}"></script>
</body>

</html>